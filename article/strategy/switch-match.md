# 스위치문을 대체하는 또 다른 방법

클린 코드를 위해 코딩 방법론을 찾아보다보면

쉽게 이런 이야기들을 찾아볼 수 있습니다.

1. else if 를 사용하지마세요.

2. switch문을 사용하지마세요

아니 그러면 도대체 어떻게 코딩을 하라는걸까요?

우리는 스위치문이 필요한 로직이 있다는 것을 알고있습니다.

하지만 스위치문 없이 어떻게 구현을 하라는것일까요?



# 스위치문을 지양하고 싶어하는 이유

솔직히 저는 스위치문을 선호하는 편입니다.

스위치문은 확장에 열려있으며 스위치문이 있다는 것만으로도

개발자에게 이 로직은 여러가지 케이스가 존재하며

그 케이스에 대해서 어떻게 행동한다라는 것을 예상하기 쉽게 해주기 때문입니다.


하지만 스위치문은 단점도 존재하는데요

문법적으로 장황해지기 쉬우며 보일러플레이트 코드가 많다는 문제와

확장에 열려있다는 점때문에 주의하여 사용하지 않는다면

스위치 케이스의 추가가 일어날떄마다 코드의 복잡도가 심해진다는 것입니다.


# 패턴 매칭의 기본적인 아이디어

패턴 매칭의 기본적인 아이디어는 아주 이해하기 쉽습니다.

스위치문과 동일한데요 특정 조건을 만족하는 경우에는 어떤 행동을 수행해라

라는 식으로 이해할 수 있습니다.

패턴 매칭은 함수형 언어에서는 자연스럽게 사용할 수 있는 기법 중 하나로

복잡한 분기 / 조건문의 사용 대신 간결한 표현식으로 조건들에 맞는 행동을 수행할 수 있습니다.

자바스크립트에서도 현재 TC39의 stage 1단계까지 진행되고 있는 상태입니다.


하지만 정식문법으로 편입하기까지는 아직 시간이 많이 걸릴 것으로 예상할 수 있으며

다행히도 자바스크립트에서 패턴 매칭을 구현하는 것이 가능합니다.

따라서 ts-pattern이라는 라이브러리를 많이 이용하곤 하는데요

이번에는 해당 라이브러리의 사용법을 소개하지는 않고

패턴 매칭의 기본적인 구조를 설명합니다.



```js
const matched = (x) => ({
  on: () => matched(x),
  otherwise: () => x,
});
const match = (x) => ({
  on: (pred, fn) => (pred(x) ? matched(fn(x)) : match(x)),
  otherwise: (fn) => fn(x),
});

const a = match(50)
  .on(
    (x) => x > 0,
    () => console.log('0보다 커요'),
  )
  .on(
    (x) => x < 55,
    () => console.log('55보다 작아요'),
  )
  .otherwise((x) => x * 10); // 50 * 10을 하고 함수진행을 끝냅니다.
```

간단하게 패턴매칭을 수행하는 코드를 작성했습니다.

각각 on / otherwise 두개의 함수가 존재하는데요

on 메서드의 첫번째 인수에 boolean을 반환하는 함수를 넣어주고

첫번째 인수의 반환값에 따라 두번째 함수를 실행할지 실행하지 않을지를 결정하는 코드입니다.

그리고 default 케이스에 대한 처리를 otherwise 메서드로 처리하는 식이지요

다만 이렇게 구현하는 것은 개발자의 오버헤드도 크고

타입스크립트에 끼워넣으려면 꽤.. 어려운 제네릭 사용이 들어가기 때문에

이를 쉽게 도와주는 라이브러리들을 사용하시는 걸 추천드리면서

마무리해보겠습니다.

# 마치며

ts-pattern 이라는 종속성이 추가되는 것이 부담스럽지만

종속성을 추가할 가치가 있을 만큼 개발자 경험이 참 좋아집니다

한번 경험해보시는 걸 추천드려요