# 기존 Stack Reconciler의 문제점

- 리액트는 비교연산(Diffing 알고리즘)의 시간복잡도는 최소 O(n^3)이며 이는 성능문제가 충분히 발생할 수 있는 수준이다.
- 따라서 기존 스택 재조정자는 약간의 휴리스틱을 첨가하여 시간복잡도를 O(n) 수준으로 낮추었다

-> 어떻게? 

1. 서로 다른 타입의 두 엘리먼트는 서로 다른 트리를 만들어 낸다.

div -> span으로 변경되는 일이 있는 경우 해당 노드는 완전히 새로 그린다.

완전히 새로 그리면 하위 트리를 비교할 필요도 없다.


2. 개발자는 고유한 유니크 아이디인 key props을 주입하여 렌더링 사이에서 어떤 자식 엘리먼트가 변경되지 않아야 하는지 표시한다.

엘리먼트의 위치가 바뀌지 않았다면 그대로 둔다.


# Reconciler는 뭐하는건데?

Reconciler는 가상돔과 실제 DOM의 상태를 적절하게 동기화해주는 일을 수행한다.

기존에는 Stack Reconciler가 이 일을 했다.


# 기존 Stack Reconciler의 문제점

Stack 재조정자는 동기적으로 재조정을 수행했다. 덕분에 비동기로 인한 버그는 피할 수 있지만 약간의 문제가 존재하는데

재조정작업이 오래걸리면 오래걸릴수록 메인스레드를 오래 블로킹해버리는 문제가 생긴다는 것이다.

그래서 리액트는 60프레임을 보장하기위해 16.6ms을 지켜주자! 라는 이야기도 나왔다.


스택 재조정자는 스택 구조인것과 Dom 이 근본적으로 트리구조라는것에서 유추할 수 있듯이 재귀 형식으로 동작한다.

모든 컴포넌트의 render를 호출하고 트리의 변경사항을 확인하고 계속 파악해나간다.



# 참고 링크

https://youngju-js.tistory.com/76


https://github.com/acdlite/react-fiber-architecture

